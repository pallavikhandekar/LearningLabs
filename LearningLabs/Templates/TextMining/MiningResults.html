<!DOCTYPE html>
<html>
  <head>
  	<link rel="stylesheet"
	href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <script type="text/javascript" src="https://www.google.com/jsapi"></script>
    <script>
		Array.prototype.contains = function(obj) {
		    var i = this.length;
		    while (i--) {
		        if (this[i][0] == obj) {
		            return true;
		        }
		    }
		    return false;
		}
	    google.load("visualization", "1", {packages:["corechart"]});
		google.setOnLoadCallback(drawChart);
		var dataChart = [['Words','Frequency']];
		  {% for key, value in data.items %}
		  	dataChart.push(['{{key}}',{{value}}]);
		  {% endfor %}
		  
		 var options = {
		    title: 'Polling Results',
		    selectionMode: 'multiple',
		    hAxis: {title: 'Answer Choice', titleTextStyle: {color: 'red'}}
		  };
		
		//Holds the selected data
		var selectedData = [];
		
		function drawChart() {
		  var data = google.visualization.arrayToDataTable(dataChart);
		  var chart = new google.visualization.ColumnChart(document.getElementById('chart_div'));
		    
		  google.visualization.events.addListener(chart, 'select', function () {
		  		//empty on every selection and recreate selected data
		  		selectedData.length = 0;
		  		selectedData.push(['Words','Frequency']);
				var selection = chart.getSelection();
		        if (selection.length) {
		        	for (i = 0; i < selection.length; i++) { 
						if(selectedData.contains(data.Ad[selection[i].row][0].Pe)==false){
		           			selectedData.push([data.Ad[selection[i].row][0].Pe,parseInt(data.Ad[selection[i].row][1].Pe)]);
		            	}
		            }
		         }
		         //var testData = google.visualization.arrayToDataTable(selectedData);
		         //chart.draw(testData, options);
				  
		  });
		  
		  chart.draw(data, options);
		  
		}
		
		function mergeData(){
			var newTitle = document.getElementById('mergeTitle').value;
			var addMergedData = 0;
			
			for (i = 1; i < selectedData.length; i++) { 
				addMergedData  =selectedData[i][1]+addMergedData;
			}
			alert(addMergedData)
		}
		
    </script>
  <body onload= "drawChart()">
  	<div align = "center">
    <div id="chart_div" style="width: 900px; height: 500px;"></div>
  	<div >
	    <label  for="mergeTitle">Merge Into Keyword:</label>
	    <input type="text" id="mergeTitle" placeholder="Merge Title">
	</div>
	<div >
  		<input class="btn btn-primary btn-lg" type="submit" value=Merge onclick="mergeData();">
  	</div>
  	</div>
  </body>
</html>
